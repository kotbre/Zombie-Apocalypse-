
<html>
	<head>
		<title>My page title</title>
	</head>
  
		<style>
			#zombie_map {
			height: 100%;
			width: 100%;
			left: 0;
			position: absolute;
			top: 0;  
			background-color: grey;}
		</style>
	
		<script async defer
			src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBXV40qQPfD4hpclx4wvQD2nsXu2WOml5w&callback=initMap&libraries=geometry">
		</script>
	
	<body>
		My zombie map
		<div id="zombie_map"></div>
		
		<script>
			var zombie_map;
			var old_position;
			var tolerance = 10;
			var score
			var data = `-33.520288161532854 151.34722709655762 zombie.png
-33.519554707218134 151.35117530822754 zombie.png
-33.5198946014543 151.35106801986694 zombie.png
-33.51739008627291 151.34606838226318 zombie.png
-33.517032292470496 151.34572505950928 zombie.png
-33.51649559899221 151.3489866256714 zombie.png
-33.517032292470496 151.34572505950928 zombie.png
-33.52347235449435 151.34482383728027 zombie.png
-33.52397322811007 151.35061740875244 zombie.png
-33.52146883102451 151.3519048690796 zombie.png
-33.51613780149027 151.35615348815918 zombie.png
-33.5210037207244 151.35744094848633 zombie.png
-33.51291755738277 151.3524627685547 zombie.png
-33.52579781460811 151.34748458862305 weapons.png
-33.52357968479906 151.35958671569824 weapons.png
-33.51456347490181 151.3520336151123 weapons.png
-33.51892858276061 151.35452270507812 hospital.png
-33.51205880537787 151.35589599609375 hospital.png
-33.51549376225768 151.35177612304688 hospital.png
-33.52357968479906 151.35958671569824 weapons.png
-33.51456347490181 151.3520336151123 weapons.png
-33.51892858276061 151.35452270507812 hospital.png
-33.51205880537787 151.35589599609375 hospital.png
-33.51549376225768 151.35177612304688 hospital.png`
			
		var markers = data.split("\n");
		var all_markers = []
		
		function initMap() {

            zombie_map = new google.maps.Map(document.getElementById('zombie_map'), {
            zoom: 14,
            center: {lat: -33.430416, lng: 151.314980}});
            
            old_position = new google.maps.Marker({
			position: {lat: -33.430416, lng: 151.314980 },
			map:zombie_map});
			
			for(var i=0; i < markers.length; i++){
				var marker_data = markers[i].trim();
				marker_data = marker_data.split(" ");
				var latitude = marker_data[0];
				var longitude = marker_data[1];
				var emoji = marker_data[2];
				var marker_position = new google.maps.LatLng(latitude,longitude);
				var marker = new google.maps.Marker({
				position: marker_position,
				map: zombie_map,
				icon: emoji});
				all_markers.push(marker);}
				
			if(navigator.geolocation) {
			navigator.geolocation.watchPosition(set_my_position);}
			else {alert("Geolocation doesn't work in your browser");}}
			
		function set_my_position(position){
			old_position.setMap(null);
			var pos = new google.maps.LatLng(position.coords.latitude,position.coords.longitude);
			var emoji = "player.png";
			var marker = new google.maps.Marker({
				position: pos,
				map: zombie_map,
				icon: emoji});
				old_position = marker;
				for(var i=0; i < all_markers.length; i++){
				var distance = google.maps.geometry.spherical.computeDistanceBetween(pos, all_markers[i].getPosition());
				if( distance < tolerance ){
                console.log("Found it!");
				var what_is_it = all_markers[i].getIcon();
				what_is_it = what_is_it.replace(".png", "");
				alert("Found the " + what_is_it );
				all_markers[i].setMap(null);
				if( what_is_it !="zombie"){
					score +=10;
					alert("your score is " + score);
				}
				}
				}
		}	
		</script>
	</body>
</html>
